<!DOCTYPE html>
<html>
  <head>
    <title>wat</title>
  </head>
  <body>
    <script type="module">
      WebAssembly.instantiateStreaming(fetch("module.wasm")).then(obj => {
        console.log(obj.instance.exports.add(1, 2))
      })

      WebAssembly.instantiateStreaming(fetch("getAnswer.wasm")).then(obj => {
        console.log(obj.instance.exports.getAnswerPlus1())
      })

      const importObject = {
        console: {
          log(arg){
            console.log(arg)
          }
        }
      }
      WebAssembly
      .instantiateStreaming(
        fetch("import.wasm"), 
        importObject
      ).then((obj) => {
        obj.instance.exports.logIt()
      })

      const global = new WebAssembly.Global({value: "i32", mutable: true}, 0)
      const importObject2 = {js: {global}}
      WebAssembly
      .instantiateStreaming(
        fetch("global.wasm"),
        importObject2
      ).then((obj) => {
        console.log(obj.instance.exports.getGlobal())
        obj.instance.exports.incGlobal()
        console.log(obj.instance.exports.getGlobal())
      })
    </script>

    <p>Open the console to see the log messages.</p>
    <p>
      Other experiments:
      <ul>
        <li><a href="/string.html">string</a></li>
        <li><a href="/table.html">table</a></li>
        <li><a href="/comparison.html">comparison</a></li>
        <li><a href="/arithmetic.html">arithmetic</a></li>
        <li><a href="/conversion.html">conversion</a></li>
      </ul>
    </p>
  </body>
</html>
